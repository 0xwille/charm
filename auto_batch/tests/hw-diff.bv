# cdh batch inputs
# variables
name := hw
N := 100

#D := GT; V := GT; U := GT
BEGIN :: types
sig1 := G1; sig2 := G1
M := ZR
d := G1; v := G1; u := G1
w := G2; Z := G2; h := G2
A := G2; r := ZR; n := ZR
i := ZR; g := G2
END :: types

BEGIN :: constant
g, w, Z, h
END :: constant

#U := e(u, g^a)
#V := e(v, g^a)
#D := e(d, g^a)
BEGIN :: precompute
n := lg_i
END :: precompute

BEGIN :: public
u, v, d
END :: public

BEGIN :: signature
sig1, sig2, r, i
END :: signature

BEGIN :: message
M
END :: message

# same signer configuration
message := N
public := N
signature := N
# sort based on the state variable, s
sort := sig#3

verify := ( e(sig1, g) == (e(u, A)^M) * (e(v,A)^r) * (e(d, A)) * e(sig2^n, w) * e(sig2^i,Z) * e(sig2, h) )

#BEGIN :: transform
#2, 3, 7
#END :: transform

BEGIN :: latex
sig1 := \sigma_1
sig2 := \sigma_2
Z := z
n := \lg(i)
END :: latex
